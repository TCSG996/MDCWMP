<!--pages/profile/index.wxml-->
<view class="container">
  <!-- æœªç™»å½•çŠ¶æ€ -->
  <view wx:if="{{!isLoggedIn}}" class="login-container">
    <view class="login-content">
      <image class="login-avatar" src="/images/avatar.png" mode="aspectFill"></image>
      <text class="login-title">æ¬¢è¿ä½¿ç”¨ç§»åŠ¨åº”ç”¨å¼€å‘ç¤¾å›¢</text>
      <text class="login-desc">è¯·å…ˆç™»å½•ä»¥æŸ¥çœ‹ä¸ªäººä¿¡æ¯</text>
      <button class="login-btn" bindtap="wxLogin">å¾®ä¿¡ç™»å½•</button>
    </view>
  </view>

  <!-- å·²ç™»å½•çŠ¶æ€ -->
  <view wx:else>
    <!-- ç”¨æˆ·ä¿¡æ¯åŒºåŸŸ -->
    <view class="user-profile">
      <view class="profile-header">
        <view class="profile-info">
          <image class="user-avatar" src="{{userInfo.avatar}}" mode="aspectFill"></image>
          <view class="user-details">
            <text class="user-name">{{userInfo.name}}</text>
            <text class="user-major">{{userInfo.major}}</text>
          </view>
        </view>
        <view class="profile-actions">
          <view class="action-btn" bindtap="onMoreOptions">
            <text class="action-icon">â‹¯</text>
          </view>
          <!--è®¾ç½®åŠŸèƒ½ã€‚å…ˆä¸å¼€å‘-->
          <!-- <view class="action-btn" bindtap="onSettings">
            <text class="action-icon">âš™ï¸</text>
          </view> -->
        </view>
      </view>
      
      <!-- ç»Ÿè®¡æ•°æ® -->
      <view class="statistics">
        <view class="stat-item">
          <text class="stat-number">{{statistics.participatedActivities}}</text>
          <text class="stat-label">å‚ä¸æ´»åŠ¨</text>
        </view>
        <view class="stat-item">
          <text class="stat-number">{{statistics.organizedActivities}}</text>
          <text class="stat-label">ç»„ç»‡æ´»åŠ¨</text>
        </view>
        <view class="stat-item">
          <text class="stat-number">{{statistics.unreadMessages}}</text>
          <text class="stat-label">æœªè¯»æ¶ˆæ¯</text>
        </view>
      </view>
    </view>

    <!-- æˆ‘çš„æ´»åŠ¨ -->
    <view class="my-activities">
      <view class="section-header" bindtap="viewMyActivities">
        <text class="section-title">æˆ‘çš„æ´»åŠ¨</text>
        <text class="section-arrow">></text>
      </view>
      
      <!-- æ´»åŠ¨åˆ—è¡¨ -->
      <view class="activity-list">
        <view wx:if="{{loading}}" class="loading">
          <text>åŠ è½½ä¸­...</text>
        </view>
        
        <view wx:elif="{{myActivities.length === 0}}" class="empty-state">
          <text>æš‚æ— æ´»åŠ¨è®°å½•</text>
        </view>
        
        <view wx:else class="activity-items">
          <view 
            wx:for="{{myActivities}}" 
            wx:key="_id"
            class="activity-item"
            bindtap="onActivityTap"
            data-id="{{item._id}}"
          >
            <view class="activity-info">
              <text class="activity-title">{{item.title}}</text>
              <view class="activity-time">
                <text class="time-icon">ğŸ“…</text>
                <text class="time-text">{{item.startTime}}</text>
              </view>
            </view>
            <view class="activity-status {{item.status === 'è¿›è¡Œä¸­' ? 'ongoing' : item.status === 'å·²ç»“æŸ' ? 'ended' : 'reviewing'}}">
              {{item.status}}
            </view>
          </view>
        </view>
      </view>
    </view>

    <!-- åŠŸèƒ½èœå• -->
    <view class="function-menu">
      <view class="menu-section">
        <view class="menu-item" bindtap="editProfile">
          <text class="menu-icon">ğŸ‘¤</text>
          <text class="menu-title">ç¼–è¾‘èµ„æ–™</text>
          <text class="menu-arrow">></text>
        </view>
        <view class="menu-item" bindtap="messageCenter">
          <text class="menu-icon">ğŸ’¬</text>
          <text class="menu-title">æ¶ˆæ¯ä¸­å¿ƒ</text>
          <text class="menu-arrow">></text>
        </view>
      </view>
      
      <view class="menu-section">
        <view class="menu-item" bindtap="helpFeedback">
          <text class="menu-icon">â“</text>
          <text class="menu-title">å¸®åŠ©åé¦ˆ</text>
          <text class="menu-arrow">></text>
        </view>
        <view class="menu-item" bindtap="aboutUs">
          <text class="menu-icon">â„¹ï¸</text>
          <text class="menu-title">å…³äºæˆ‘ä»¬</text>
          <text class="menu-arrow">></text>
        </view>
      </view>
    </view>
  </view>
</view>